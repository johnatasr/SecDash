{"version":3,"sources":["Demo/Charts/Nvd3Chart/MultiBarChart.js","Demo/Charts/Nvd3Chart/ChartTopTen.js","Demo/Dashboard/Default.js"],"names":["MultiBarChart","state","data","baixa","media","alta","critico","hostServices","HostServices","getGraphs","response","status","loaded","length","this","setState","severitylow","severityMedium","severityHigh","severityCritical","list_vulne","Math","min","i","push","title","cvss","values","key","color","type","datum","x","y","height","showValues","showXAxis","groupSpacing","React","Component","ChartTopTen","getTopTen","topTen","hostname","cvssTotal","tooltip","enabled","barColor","Dashboard","totalHosts","totalHostsVulne","totalVulne","notCorrectedVulne","severity","mediaCVSS","getCards","localStorage","clear","props","history","totalVulnerabilities","notCorrected","Row","Col","md","xl","Card","className","Body","style","paddingRight","paddingLeft","paddingBottom","sm","Header","Title","as"],"mappings":"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","file":"js/11.9b02e5dd.chunk.js","sourcesContent":["import React from 'react';\r\nimport HostServices from '../../../services/hostsServices'\r\nimport NVD3Chart from 'react-nvd3';\r\n\r\n\r\nclass MultiBarChart extends React.Component {\r\n    constructor(){\r\n        super();\r\n        this.state={\r\n            data: []\r\n        }\r\n    }\r\n\r\n    async componentDidMount(){\r\n\r\n        let baixa = [],\r\n        media = [],\r\n        alta = [],\r\n        critico = [];\r\n\r\n        const hostServices = new HostServices();\r\n        \r\n        let response = await hostServices.getGraphs();\r\n\r\n        if ( response != false ) {\r\n\r\n            if (( response.status == 200 || response.status == 201 ) && response.data.loaded == true){\r\n\r\n                if ( response.data.length === 0) {\r\n                    this.setState({data: []})\r\n                    return\r\n                }\r\n\r\n                let severitylow = response.data.severitylow;\r\n                let severityMedium = response.data.severityMedium;\r\n                let severityHigh = response.data.severityHigh;\r\n                let severityCritical = response.data.severityCritical;\r\n\r\n                let list_vulne = [ \r\n                    severitylow.length, \r\n                    severityMedium.length, \r\n                    severityHigh.length, \r\n                    severityCritical.length\r\n                ]\r\n    \r\n                let lengthMin = Math.min( ...list_vulne );\r\n    \r\n                for (let i = 0; i < severitylow.length; i++) {\r\n                    baixa.push({\r\n                        'x': severitylow[i].title,\r\n                        'y': severitylow[i].cvss\r\n                    });\r\n                }\r\n                \r\n                for (let i = 0; i < severityMedium.length; i++) {\r\n                    media.push({\r\n                        'x': severityMedium[i].title,\r\n                        'y': severityMedium[i].cvss\r\n                    });\r\n                }\r\n    \r\n                for (let i = 0; i < severityHigh.length; i++) {\r\n                    alta.push({\r\n                        'x': severityHigh[i].title,\r\n                        'y': severityHigh[i].cvss\r\n                    });\r\n                }\r\n    \r\n                for (let i = 0; i < severityCritical.length; i++) {\r\n                    critico.push({\r\n                        'x': severityCritical[i].title,\r\n                        'y': severityCritical[i].cvss\r\n                    });\r\n                }\r\n            }\r\n            \r\n        }\r\n\r\n        this.setState({\r\n            data: [\r\n                {\r\n                    values: baixa,\r\n                    key: 'Baixa',\r\n                    color: '#1df7b6'\r\n                },\r\n                {\r\n                    values: media,\r\n                    key: 'Média',\r\n                    color: '#f1f504'\r\n                },\r\n                {\r\n                    values: alta,\r\n                    key: 'Alta',\r\n                    color: '#e9a11d',\r\n                },\r\n                {\r\n                    values: critico,\r\n                    key: 'Crítico',\r\n                    color: '#f71d1d',\r\n                }\r\n            ]\r\n        }) \r\n    }\r\n    \r\n    render() {\r\n        return <NVD3Chart type=\"multiBarChart\" datum={this.state.data} x=\"x\" y=\"y\" height={300} showValues=\"false\" showXAxis={false} groupSpacing={0.1} />\r\n    }\r\n}\r\n\r\nexport default MultiBarChart;","import React from 'react';\r\nimport NVD3Chart from 'react-nvd3';\r\nimport HostServices from '../../../services/hostsServices'\r\n\r\nclass ChartTopTen extends React.Component {\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            data: []\r\n        }\r\n    }\r\n\r\n    async componentDidMount() {\r\n\r\n        const hostServices = new HostServices();\r\n        \r\n        let response = await hostServices.getTopTen();\r\n        let topTen = [];\r\n\r\n        if ( response != false ) {\r\n\r\n            if ( (response.status == 200 ||  response.status == 201) && response.data.loaded == true ){\r\n                for (let i = 0; i < response.data.topTen.length; i++) {\r\n                    topTen.push({\r\n                        'x': response.data.topTen[i].hostname,\r\n                        'y': response.data.topTen[i].cvssTotal\r\n                    });\r\n                }\r\n\r\n                this.setState({\r\n                    data: [\r\n                        { values: topTen }\r\n                    ]\r\n                }) \r\n            } \r\n        }\r\n\r\n        \r\n    }\r\n    \r\n    render() {\r\n\r\n        const barColor = ['#1df7b6', '#a9b7d0', '#9e8dd4', '#25a9cb', '#04a9f5'];\r\n\r\n        return <NVD3Chart tooltip={{enabled: true}} type=\"discreteBarChart\" datum={this.state.data} x=\"label\" y=\"value\" barColor={barColor} height={300} showValues />\r\n    }\r\n}\r\n\r\nexport default ChartTopTen;","import React from 'react';\r\nimport {Row, Col, Card} from 'react-bootstrap';\r\n\r\nimport HostServices from '../../services/hostsServices'\r\n\r\nimport Aux from \"../../hoc/_Aux\";\r\nimport MultiBarChart from \"../Charts/Nvd3Chart/MultiBarChart\";\r\nimport ChartTopTen from \"../../Demo/Charts/Nvd3Chart/ChartTopTen\"\r\n\r\nconst hostServices = new HostServices();\r\n\r\nclass Dashboard extends React.Component {\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            totalHosts: 0,\r\n            totalHostsVulne: 0,\r\n            totalVulne: 0,\r\n            notCorrectedVulne: 0,\r\n            severity: 'Não definida',\r\n            mediaCVSS: 0.0,\r\n        }\r\n    }\r\n\r\n\r\n    async componentDidMount(){\r\n        try{\r\n            let response = await hostServices.getCards();\r\n            \r\n            if ( response != false ) {\r\n\r\n                if ( (response.status == 200 ||  response.status == 201) && response.data.loaded == true ) {\r\n                    this.setState({\r\n                        totalHosts: response.data.totalHosts,\r\n                        totalHostsVulne: response.data.totalHostsVulne,\r\n                        totalVulne: response.data.totalVulnerabilities,\r\n                        notCorrectedVulne: response.data.notCorrected,\r\n                        severity: response.data.severity,\r\n                        mediaCVSS: response.data.mediaCVSS\r\n                    })\r\n                }\r\n\r\n                else if ( response.status == 401 ) {\r\n                    localStorage.clear(); \r\n                    this.props.history.push('/');\r\n                }\r\n                \r\n            } else {\r\n                localStorage.clear(); \r\n                this.props.history.push('/');\r\n            }\r\n        }\r\n        catch(error){\r\n            localStorage.clear(); \r\n            this.props.history.push('/');\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let totalHosts = this.state.totalHosts;\r\n        let totalHostsVulne = this.state.totalHostsVulne;\r\n        let totalVulne= this.state.totalVulne;\r\n        let notCorrectedVulne = this.state.notCorrectedVulne;\r\n        let severity = this.state.severity;\r\n        let mediaCVSS = this.state.mediaCVSS;\r\n\r\n\r\n        return (\r\n            <Aux>\r\n                <Row>\r\n                    <Col md={6} xl={4}>\r\n                        <Card className='card-event'>\r\n                            <Card.Body>\r\n                                <div className=\"row align-items-center justify-content-center\">\r\n                                    <div className=\"col\">\r\n                                        <h5 className=\"m-0\">Hosts</h5>\r\n                                    </div>\r\n                                </div>\r\n                                <div className='row align-items-center justify-content-center'>\r\n                                    <div className=\"col\">\r\n                                        <h2 className=\"mt-2 f-w-300\">{totalHosts}<sub className=\"text-muted f-14\">Total</sub></h2>\r\n                                        <h6 className=\"text-muted mt-3 mb-0\">Todos Hosts registrados</h6>\r\n                                    </div>\r\n                                    <div className=\"col\">\r\n                                        <h2 className=\"mt-2 f-w-300\">{totalHostsVulne}<sub className=\"text-muted f-14\">Vulneráveis</sub></h2>\r\n                                        <h6 className=\"text-muted mt-3 mb-0\">Hosts com vulnerabilidades</h6>\r\n                                        <i className=\"fa fa-exclamation-triangle text-c-yellow f-50\"/>\r\n                                    </div>\r\n                                </div>      \r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Col>\r\n                    <Col md={6} xl={4}>\r\n                        <Card className='card-event'>\r\n                            <Card.Body>\r\n                                <div className=\"row align-items-center justify-content-center\">\r\n                                    <div className=\"col\">\r\n                                        <h5 className=\"m-0\">Vulnerabilidades</h5>\r\n                                    </div>\r\n                                </div>\r\n                                <div className='row align-items-center justify-content-center'>\r\n                                    <div className=\"col\" style={{paddingRight: 0}}>\r\n                                        <h2 className=\"mt-2 f-w-300\">{totalVulne}<sub className=\"text-muted f-14\">Total</sub></h2>\r\n                                        <h6 className=\"text-muted mt-3 mb-0\">Vulnerabilidades detectadas</h6>\r\n                                    </div>\r\n                                    <div className=\"col\" style={{paddingLeft:0}}>\r\n                                        <h2 className=\"mt-2 f-w-300\">{notCorrectedVulne}<sub className=\"text-muted f-14\">Total</sub></h2>\r\n                                        <h6 className=\"text-muted mt-3 mb-0\">Vulnerabilidades não corrigidas</h6>\r\n                                        <i className=\"fa fa-exclamation-triangle text-c-yellow f-50\"/>\r\n                                    </div>\r\n                                </div>\r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Col>\r\n                    <Col xl={4}>\r\n                        <Card className='card-event'>\r\n                            <Card.Body>\r\n                                <div className=\"row align-items-center justify-content-center\">\r\n                                    <div className=\"col\">\r\n                                        <h5 className=\"m-0\">Média</h5>\r\n                                    </div>\r\n                                    <div className=\"col-auto\">\r\n                                <label className=\"label theme-bg2 text-white f-14 f-w-400 float-right\">CVSS GERAL: {mediaCVSS}</label>\r\n                                    </div>\r\n                                </div>\r\n                                <h2 className=\"mt-2 f-w-300\" style={{paddingBottom: 13.5}}>{severity}<sub className=\"text-muted f-14\"> para todos hosts</sub></h2>\r\n                                <i className=\"fa fa-exclamation-triangle text-c-yellow f-50\"/>\r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Col>\r\n                    <Col sm={12}>\r\n                        <Card>\r\n                            <Card.Header>\r\n                                <Card.Title as=\"h5\">Vulnerabilidade por severidade</Card.Title>\r\n                            </Card.Header>\r\n                            <Card.Body>\r\n                                <MultiBarChart/>\r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Col>\r\n                    <Col sm={12}>\r\n                        <Card>\r\n                            <Card.Header>\r\n                                <Card.Title as=\"h5\">Hosts mais vulneráveis</Card.Title>\r\n                            </Card.Header>\r\n                            <Card.Body>\r\n                                <ChartTopTen />\r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Col>       \r\n                </Row>\r\n            </Aux>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Dashboard;"],"sourceRoot":""}